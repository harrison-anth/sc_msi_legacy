
library(Seurat)
library(gridExtra)
library(patchwork)
library(tidyverse)
library(scAnnotatR)
library(data.table)
library(cowplot)
library(Nebulosa)
library(ggpubr)
library(R.utils)
set.seed(seed = 152727)



sample_name <-'EXT016'
s_obj <- assign(x = paste0(sample),value = readRDS(paste0('../annotated_h5/',sample,'.rds')))
sample <- sample_name
s_obj <- assign(x = paste0(sample),value = readRDS(paste0('../annotated_h5/',sample,'.rds')))

sensor2_global <- fread(paste0('../sensor2_results/',sample_name,'_msi_status'))

msings_global <- as.numeric(fread(paste0('../msings_results/', sample_name,'_msi_status.MSI_Analysis.txt'))[3,2])*100

pro_global <- fread(paste0('../pro_results/',sample_name,'_msi_status'))

atomic_cells <- readRDS(paste0('../atomic/',sample_name,'.rds'))

s_obj$scATOMIC_pred <- atomic_cells$scATOMIC_pred
s_obj$pan_cancer_cluster <- atomic_cells$pan_cancer_cluster
s_obj$sensor_rna_prob <- as.numeric(s_obj$sensor_rna_prob)



print(FeaturePlot(s_obj,features=c('sensor2'),cols=c('blue','red'))
)
print(FeaturePlot(s_obj,features=c('sensor2'),cols=c('blue','red'))
)
)
print(FeaturePlot(s_obj,features=c('sensor2'),cols=c('blue','red'))
)
quit()
